<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-2"/>
    <title>Projekt IIS</title>
    <style type="text/css">
        html {
            font-family: "BryantProRegular", 'Helvetica Neue', helvetica, arial, sans-serif, "Helvetica Neue";
        }

        body {
            max-width: 1080px;
            margin: 0 auto;
        }

        table {
            border-collapse: collapse;
        }

        td, th {
            border: 1px solid black;
            padding: 0.3em 0.5em;
            text-align: left;
        }

        dt {
            font-weight: bold;
            margin-top: 0.5em;
        }

        img {
            max-width: 100%;
            padding: 5px;
            border: 2px solid gray;
        }

        code {
            color: #a965d1;
            background-color: #a965d110;
            font-weight: bold;
            padding: 2px;
            display: inline-block;
        }

        pre {
            color: #a965d1;
        }

        p {
            text-align: justify;
        }
    </style>
</head>
<body>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu 
     podle pou¾itého editoru -->

<h1>Správa ZOO</h1>

<dl>
    <dt>Autoøi</dt>
    <dd>Josef Koláø
        <a href="mailto:xkolar71@stud.fit.vutbr.cz">xkolar71@stud.fit.vutbr.cz</a> -
        architektura, modelová vrstva, dynamické komponenty, produkèní nasazení
    </dd>
    <dd>Iva Kavánková
        <a href="mailto:xkavan05@stud.fit.vutbr.cz">xkavan05@stud.fit.vutbr.cz</a> -
        textace, u¾ivatelské formuláøe, testování
    </dd>
    <dd>Son Hai Nguyen
        <a href="mailto:xnguye16@stud.fit.vutbr.cz">xnguye16@stud.fit.vutbr.cz</a> -
        vizuál, øídící vrstva, testování
    </dd>
    <dt>URL aplikace</dt>
    <dd><a href="https://zis.josefkolar.cz/">https://zis.josefkolar.cz/</a></dd>
</dl>

<h2>U¾ivatelé systému pro testování</h2>
<p>Uveïte prosím existující zástupce <strong>v¹ech rolí u¾ivatelù</strong>.</p>
<table>
    <tr>
        <th>Login</th>
        <th>Heslo</th>
        <th>Role</th>
    </tr>
    <tr>
        <td>admin</td>
        <td>Zadmin</td>
        <td>Administrátor</td>
    </tr>
    <tr>
        <td>reditel</td>
        <td>Zreditel</td>
        <td>Øeditel</td>
    </tr>
    <tr>
        <td>spravce</td>
        <td>Zspravce</td>
        <td>Správce</td>
    </tr>
    <tr>
        <td>osetrovatel</td>
        <td>Zosetrovatel</td>
        <td>O¹etøovatel</td>
    </tr>
</table>
<h2>Diagram pøípadù u¾ití</h2>
<div>
    <a href="./use-case.png"><img src="./use-case.png" alt="Use case"></a>
</div>
<h2>Implementace</h2>
<p>
    Vzhledem k implementaci v frameworku <i>Django</i> je struktura a architektura projektu navrhnuta dle doporuèovaných
    konvencí v tomto nástroji. S vyu¾itím návrhového vzoru MVC jsou v projektu oddìleny zodpovìdnosti jednotlivých
    vrstev.
    Dále budou popsány jednotlivé vrstvy a jejich funkce v rámci jednotlivých pøípadù u¾ití plynoucích ze zadání.
</p>
<h3>Modelová vrstva</h3>
<p>
    Modelová vrstva obsahuje kompletní definici datové struktury systému, tedy tøídy jako potomky
    <code>django.db.models.Model</code> reprezentující entitiní mno¾inu z pohledu ER <i>(dále jen Modely)</i>
    - existují tedy základní modely jako <code>Animals</code>, <code>Person</code>,
    <code>Enclosure</code> èi <code>Feeding</code>, resp. <code>Cleaning</code>. Mezi tìmito základními modely jsou
    poté navázané rùzné relaèní modely, napøíklad pøiøazení osoby k èi¹tìní <code>CleaningPerson</code> èi <code>AnimalStay</code>,
    jako¾to model reprezentující zaøazení zvíøete ve výbìhu. Definice v¹ech modelù, jako¾to tøíd, jsou umístìny
    strukturovanì v balíèku <code>ziscz/core/models/</code>.
</p>
<p>
    Jednotlivé atributy modelù (entitních mno¾in) jsou nejèastìji definovány spoleènì se svými datovými omezeními, tedy
    napø. pro délku èi¹tìní/krmení je definován atribut <code>length</code> pøímo s validátorem na minimální délku
    trvání 15 minut, stejnì jako se svou výchozí hodnotou a pøelo¾eným popiskem pro dal¹í pou¾ití:
</p>
<pre>
length = models.<strong>DurationField</strong>(
    verbose_name=<strong>_('Length')</strong>,
    validators=[<strong>MinValueValidator(timedelta(minutes=15))</strong>],
    default=<strong>timedelta(minutes=15)</strong>,
)
</pre>
<p>
    Takto definované atributy díky frameworku Django zaji¹tují i validace na úrovni formuláøù, o kterých bude zmínka
    dále.
</p>
<p>
    Takté¾ tento framework zaji¹tuje verzování databázového schématu pomocí migrací, tedy i multiplatformost z hlediska
    SØBD vèetnì generování skriptù v jazyce SQL pro úpravu schématu - to v¹e pro konzistentní chování objektovì
    relaèního mapováním nad definovanými modely. Ní¾e jejich struktura: <i>(pro pøehlednost nejsou zahrnuty èíselníkové
    modely, jako je typ role osoby, zvíøete èi výbìhu)</i>.
</p>

<div>
    <a href="./models.png"><img src="./models.png" alt="Modely"></a>
</div>


<h3>Prezentaèní vrstva</h3>
<p>
    Prezentaèní vrstva se z pohledu pou¾itého frameworku zú¾uje pøedev¹ím na ¹ablony v ¹ablonovacím jazyce <i>Django
    Templates</i> - v zásadì není tento jazyk omezený na generování konkrétního jazyka, v pøípadì tohoto projektu je
    ov¹em generováno standardní HTML. V projektu jsou ¹ablony umístìny ve slo¾kách s pøíznaèným názvem
    <code>templates/</code>.
</p>
<p>
    S prezentaèní vrstou jsou spjaty ve¹keré formuláøe pro vytváøení a úpravu jednotlivých entit v systému. Díky
    frameworku je
    s pomocí tøídy <code>django.forms.ModelForm</code> mo¾no tyto formuláøe pøímo generovat z definice jednotlivých
    modelù.
    Z pohledu pøípadù u¾ití jsou pomocí tìchto formuláøù splnìny pøípady u¾ití týkající se jednoduché úpravy
    zvíøat/výbìhù/osob, stejnì tak jako plánování èi¹tìní a krmení.
</p>


<h2>Instalace</h2>
<ul>
    <li>
        Pro vývoj jsou zapotøebí následující technologie/nástroje:
        <ul>
            <li><code>Python</code> ve verzi 3.5 èi vy¹¹í</li>
            <li><code>PostgreSQL</code> 9.6 èi vy¹¹í <i>(alternativnì jiný SØBD, bez záruky MySQL ¹i SQLite)</i></li>
            <li><code>npm</code> >= 6.1.0</li>
            <li><code>node</code> >= 9.11.2</li>
        </ul>
        Pro produkèní pou¾ití jsou následnì doporuèovány slu¾by <code>gunicorn</code> a <code>nginx</code>.
    </li>
    <li>
        Vzhledem k implementaci v jazyce Python 3 je doporuèeno vytvoøit virtuální prostøedí a aktivovat jej:
        <code>$ pyvenv .venv && . .venv/bin/activate</code>.
    </li>
    <li>
        Do aktivního prostøedí je následnì nutné nainstalovat projekt se v¹emi jeho závislostmi:
        <code>$ pip install .</code>.
    </li>
    <li>
        Poté nainstalovat i frontend závislosti projektu: <code>$ npm ci</code> a sestavit balíèky pro frontend:
        <code>$ npm run build</code>.
    </li>
    <li>
        Dle souboru s ¹ablonou pro Django nastavení <code>settings.py.template</code> vytvoøte soubor
        <code>settings.py</code>, do kterého nastavte údaje pro pøipojení k databázi a vygenerujte náhodný klíè.
    </li>
    <li>
        Inicializaci schématu databáze lze provést pomocí migrací, v aktivovaném virtuálním prostøedí:
        <code>PYTHONPATH=. python ./ziscz/manage.py migrate</code>.
    </li>
    <li>
        Následující pøíkaz poté spustí vývojáøský server
        <code>PYTHONPATH=. python ./ziscz/manage.py runserver</code>.
    </li>
</ul>

<h2>Známé problémy</h2>
<p>
    Zde popi¹te, které body zadání (IDS a IIS) nejsou implementovány a z jakého dùvodu. Napø. &bdquo;Z èasových dùvodù
    nebyla implementována správa u¾ivatelù.&rdquo; Pomù¾ete tím zrychlit opravování, kdy¾ neimplementované funkce
    nebudeme muset dlouze hledat.
</p>

</body>
</html>
